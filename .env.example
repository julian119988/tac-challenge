# FastAPI Webhook Server Configuration
# Copy this file to .env and fill in your values

# ============================================================================
# REQUIRED SETTINGS
# ============================================================================

# GitHub Webhook Secret
# Generate a strong random secret (at least 16 characters)
# Use the same secret when configuring the webhook in GitHub repository settings
# Example: python -c "import secrets; print(secrets.token_urlsafe(32))"
GH_WB_SECRET=your-secret-here-change-this

# Anthropic API Key (required for ADW workflows)
# Get your API key from: https://console.anthropic.com/
ANTHROPIC_API_KEY=sk-ant-your-api-key-here

# ============================================================================
# SERVER SETTINGS (Optional - defaults provided)
# ============================================================================

# Server host address (default: 0.0.0.0 - listens on all interfaces)
SERVER_HOST=0.0.0.0

# Server port (default: 8000)
SERVER_PORT=8000

# ============================================================================
# ADW SETTINGS (Optional - defaults provided)
# ============================================================================

# Working directory for ADW workflow execution
# Default: current directory where server is started
# ADW_WORKING_DIR=/path/to/your/project

# Default model for ADW workflows (sonnet or opus)
# Default: sonnet
ADW_DEFAULT_MODEL=sonnet

# ============================================================================
# REVIEW ACTION SETTINGS (Optional - defaults provided)
# ============================================================================

# Automatically merge PRs when review is approved
# Default: true
AUTO_MERGE_ON_APPROVAL=true

# Automatically trigger re-implementation when review requests changes
# Default: true
AUTO_REIMPLEMENT_ON_CHANGES=true

# PR merge method (squash, merge, rebase)
# Default: squash
MERGE_METHOD=squash

# Maximum re-implementation attempts per issue to prevent loops
# Default: 3
MAX_REIMPLEMENT_ATTEMPTS=3

# ============================================================================
# STATIC FILES (Optional - defaults provided)
# ============================================================================

# Directory for serving static frontend files
# Default: apps/static (relative to project root)
# STATIC_FILES_DIR=apps/static

# ============================================================================
# CORS SETTINGS (Optional - defaults provided)
# ============================================================================

# Enable CORS middleware (default: true)
CORS_ENABLED=true

# Allowed CORS origins (comma-separated)
# Default: * (allow all origins)
# For production, restrict to specific domains:
# CORS_ORIGINS=https://yourdomain.com,https://app.yourdomain.com
# CORS_ORIGINS=*

# ============================================================================
# LOGGING (Optional - defaults provided)
# ============================================================================

# Logging level (DEBUG, INFO, WARNING, ERROR, CRITICAL)
# Default: INFO
LOG_LEVEL=INFO

# ============================================================================
# ENVIRONMENT (Optional - defaults provided)
# ============================================================================

# Deployment environment (development, staging, production)
# Default: development
ENVIRONMENT=development

# ============================================================================
# CLAUDE CODE SETTINGS (Required for ADW execution)
# ============================================================================

# Path to Claude Code CLI executable
# Default: claude (assumes it's in PATH)
# CLAUDE_CODE_PATH=claude

# Maintain project working directory in bash commands
# Default: true
CLAUDE_BASH_MAINTAIN_PROJECT_WORKING_DIR=true

# ============================================================================
# SETUP INSTRUCTIONS
# ============================================================================

# 1. Copy this file to .env:
#    cp .env.example .env

# 2. Generate a strong webhook secret:
#    python -c "import secrets; print(secrets.token_urlsafe(32))"

# 3. Set your GH_WB_SECRET and ANTHROPIC_API_KEY in .env

# 4. Configure GitHub webhook:
#    - Go to your repository Settings → Webhooks → Add webhook
#    - Set Payload URL: https://your-server.com/webhooks/github
#    - Set Content type: application/json
#    - Set Secret: (same as GH_WB_SECRET)
#    - Select individual events: Issues, Pull requests
#    - Save webhook

# 5. Install dependencies:
#    pip install -r requirements.txt

# 6. Start the server:
#    python apps/webhook_server.py
#    # or
#    uvicorn apps.webhook_server:app --host 0.0.0.0 --port 8000

# ============================================================================
# PRODUCTION DEPLOYMENT NOTES
# ============================================================================

# For production deployment:
# - Set ENVIRONMENT=production
# - Use a strong random GH_WB_SECRET (32+ characters)
# - Restrict CORS_ORIGINS to your specific domains
# - Set LOG_LEVEL=WARNING or ERROR
# - Use HTTPS (configure reverse proxy like nginx or caddy)
# - Consider running with multiple uvicorn workers
# - Set up monitoring and alerting
# - Back up .env file securely (but don't commit it to git!)
